﻿@using PhoneShop.Models
@using PhoneShop.ModelViews

@model List<PhoneShop.ModelViews.ProductViewModel>

@{


    List<CategoryModelView> ListLogo = ViewBag.ListLogo;

    List<ImageProductViewModel> IsCourseContents = ViewBag.imageproduct;

    List<BannerViewModel> banneViews = ViewBag.ListBanner;

    //format tien

    // Lấy mã vùng địa phương cho tiếng Việt nếu có, nếu không thì chọn một mã vùng khác
    CultureInfo culture = CultureInfo.GetCultures(CultureTypes.SpecificCultures)
                                    .FirstOrDefault(c => c.Name.StartsWith("vi", StringComparison.OrdinalIgnoreCase))
                           ?? CultureInfo.CurrentCulture;

    int tienO = 0;
}

@if (TempData["Message"] != null)
{
    <div class="alert alert-success">
        @TempData["Message"]
    </div>
}
@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger">
        @TempData["ErrorMessage"]
    </div>
}


<a href="/HomeController/DemoExport_File">Export file</a>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="slider-area">
    <!-- Slider -->
    <div class="block-slider block-slider4">
        <ul class="" id="bxslider-home4">
            
            

            @await Html.PartialAsync("_Partial_Banner_Images",banneViews)

        </ul>
    </div>
    <!-- ./Slider -->
</div> <!-- End slider area -->

<div class="promo-area">
    <div class="zigzag-bottom"></div>
    <div class="container">
        <div class="row">
            <div class="col-md-3 col-sm-6">
                <div class="single-promo promo1">
                    <i class="fa fa-refresh"></i>
                    <p>30 Days return</p>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="single-promo promo2">
                    <i class="fa fa-truck"></i>
                    <p>Free shipping</p>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="single-promo promo3">
                    <i class="fa fa-lock"></i>
                    <p>Secure payments</p>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="single-promo promo4">
                    <i class="fa fa-gift"></i>
                    <p>New products</p>
                </div>
            </div>
        </div>
    </div>
</div> <!-- End promo area -->

<div class="maincontent-area">
    <div class="zigzag-bottom"></div>
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="latest-product">
                    <h2 class="section-title">Latest Products</h2>
                    <div class="product-carousel">

                         @if (Model != null)    
                        {
                            foreach (var item in Model)
                            {
                                <div class="single-product">
                                    <div class="product-f-image">
@*                                         <img src="~/User/img/product-1.jpg" alt="">
                                *@            <img src="~/images/Product/@item.ImageDefaultName" style="border: solid 1px;height:296px; width:220px" />
                                       
                                        <div class="product-hover">
                                            <a  class="add-to-cart-link confirmAdd" data-id="@item.Id" ><i class="fa fa-shopping-cart"></i> Add to cart</a>
                                            <a href="/chi-tiet/@item.Alias-@item.Id" class="view-details-link"><i class="fa fa-link"></i> See details</a>
                                        </div>
                                    </div>

                                    <h2><a href="single-product.html">@item.Title</a></h2>

                                    <div class="product-carousel-price">
                                        

                                        @{
                                            if (item.Discount == 0 || item.Discount == null || item.Discount is string)
                                            {
                                                <ins>
                                                    @{



                                                        string formattedPrice = item.Price.ToString("C", culture); // "C" là định dạng tiền tệ




                                                    }
                                                    @formattedPrice
                                                </ins>
                                            }
                                            else
                                            {
                                                <ins>
                                                    @{



                                                        string formattedPrice = item.Discount.ToString("C", culture); // "C" là định dạng tiền tệ




                                                    }
                                                    @formattedPrice
                                                </ins>
                                            }
                                        }

                                        <del>@{
                                                string formattedPrice2 ;
                                                if (item.Discount > 0)
                                                {
                                                     formattedPrice2 = item.Price.ToString("C", culture); // "C" là định dạng tiền tệ
                                                }
                                                else
                                                {

                                                     formattedPrice2 = tienO.ToString("C", culture); // "C" là định dạng tiền tệ
                                                }


                                            }
                                            @formattedPrice2



                                           
                                        </del>
                                    </div>
                                </div>
                            }
                        }


                        
                       
                      
                       
                    </div>
                </div>
            </div>
        </div>
    </div>
</div> <!-- End main content area -->

<div class="brands-area">
    <div class="zigzag-bottom"></div>
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="brand-wrapper">
                    <div class="brand-list">
                        
                         @if (Model != null && Model.Count() > 0)
                            {
                                                @foreach (var item_course in ListLogo)
                                                {
                                                      <a href="/@item_course.Alias-@item_course.Id"> <img src="~/images/Category/@item_course.Image" alt=""></a>
                                                }
                            }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div> <!-- End brands area -->

<div class="product-widget-area">
    <div class="zigzag-bottom"></div>
    <div class="container">
        <div class="row">
           
           
            

            @if (Model != null)
            {
                foreach (var item in Model)
                {
                    <div class="col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2">
                    <div class="single-product">
                        <div class="product-f-image">
                            @*                                         <img src="~/User/img/product-1.jpg" alt="">
                    *@            <img src="~/images/Product/@item.ImageDefaultName" style="border: solid 1px;height:296px; width:220px" />

                            <div class="product-hover">
                                <a class="add-to-cart-link confirmAdd" data-id="@item.Id"><i class="fa fa-shopping-cart"></i> Add to cart</a>
                                <a href="/chi-tiet/@item.Alias-@item.Id" class="view-details-link"><i class="fa fa-link"></i> See details</a>
                            </div>
                        </div>

                        <h2><a href="single-product.html">@item.Title</a></h2>

                        <div class="product-carousel-price">


                            @{
                                if (item.Discount == 0 || item.Discount == null || item.Discount is string)
                                {
                                    <ins>
                                        @{



                                            string formattedPrice = item.Price.ToString("C", culture); // "C" là định dạng tiền tệ




                                        }
                                        @formattedPrice
                                    </ins>
                                }
                                else
                                {
                                    <ins>
                                        @{



                                            string formattedPrice = item.Discount.ToString("C", culture); // "C" là định dạng tiền tệ




                                        }
                                        @formattedPrice
                                    </ins>
                                }
                            }

                            <del>
                                @{
                                    string formattedPrice2;
                                    if (item.Discount > 0)
                                    {
                                        formattedPrice2 = item.Price.ToString("C", culture); // "C" là định dạng tiền tệ
                                    }
                                    else
                                    {

                                        formattedPrice2 = tienO.ToString("C", culture); // "C" là định dạng tiền tệ
                                    }


                                }
                                @formattedPrice2




                            </del>
                        </div>
                    </div>
                    </div>
                }
            }

            <!-- Các sản phẩm tiếp theo -->
        </div>
    </div>
</div> <!-- End product widget area -->


@section Scripts{

    <script>
        $(document).ready(function () {
            $('body').on('click', '.confirmAdd', function () {
                var id = $(this).data('id');

               

              

                    $.ajax({

                        url: '/Cart/Add',
                        type: 'post',
                        data: { id: id },
                        success: function (rs) {
                            if (rs.success) {
                                alert("Thêm thành công");
                               
                                location.reload();
                            }
                        }

                    });

               
            });
        });
    </script>


}