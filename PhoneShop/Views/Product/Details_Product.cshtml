@model PhoneShop.ModelViews.ProductViewModel
@using PhoneShop.Data;
@using PhoneShop.ModelViews;
@using PhoneShop.Extension;
@using PhoneShop.Models;
@{
    ViewData["Title"] = "Details_Product";
    Layout = "~/Views/Shared/_Layout.cshtml";

    List<ImageProductViewModel> IsImage = ViewBag.getListImage;

    List<Product_ReviewModelView> IsAsk = ViewBag.ListAsk;

    SpecificationsViewModel Ispecifi = ViewBag.GetSpecifi;


    List<ProductViewModel> IsSellingProduct = ViewBag.SellingProduct;



    Evaluate_ProductViewModel IsEvaluate_Pro = ViewBag.Evaluate_Product;

    BoothData GetBooth = ViewBag.GetBooth;

    List<Voucher> GetListVoucher = ViewBag.istVoucherBooth;



    List<Review_Product> IsReview = ViewBag.ListReview;
    

    double tienO = 0;

}



<link href="~/user/css/detail_product_user.css" rel="stylesheet" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<style>
    .container-question{
        border: 1px solid #ccc;
       margin:-12pt;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
      
    }

    .rating-container {
        display: flex;
        justify-content: center;
    }

        .rating-container input[type="radio"] {
            display: none;
        }

        .rating-container label {
            font-size: 30px;
            color: #ccc;
            cursor: pointer;
        }

        .rating-container input[type="radio"]:checked ~ label {
            color: #ffd700;
        }
</style>


<div class="single-product-area" style="padding-top:10px">
    <div class="zigzag-bottom"></div>
    <div class="container">
        <div class="row" style="background:white">
            <div class="container">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb" style="background:white;padding:10px">
                        <li class="breadcrumb-item" style="font-size: 18px;"><a href="#">Trang chủ</a></li>
                        <li class="breadcrumb-item active" style="font-size: 18px;" aria-current="page">@ViewBag.getCategoryTitle</li>
                        <li class="breadcrumb-item active" style="font-size: 18px;" aria-current="page">@Model.Title</li>
                    </ol>
                </nav>
            </div>

            <div class="col-md-12" style="">
                <div class="product-content-right"> 
                  

                    <div class="row" >
                        <div class="col-sm-6">
                            <div class="image-gallery">
                                <div class="image-container product-main-img" style="max-width:290px">
                                    <img style="height:300px; width:300px" src="~/images/Product/@Model.ImageDefaultName" alt="Image 12" class="active">
                                </div>
                                <div class="thumbnail-container" style="margin-right:350px">
                                    @await Html.PartialAsync("_PartialListImage",IsImage)
                                   
                                </div>
                            </div>

                           
                        </div>

                        <div class="col-sm-6">
                            <div class="product-inner">
                                <h2 class="product-name">@Model.Title</h2>
                                <div class="product-inner-category"> 
                                    <p>Hãng: <a href="">@ViewBag.getCategoryTitle</a></p>
                                    <p class="detail-label">Bán: @IsEvaluate_Pro.Purchases</p>
                                    <p class="detail-label">Đánh Giá @IsEvaluate_Pro.ScoreEvaluation điểm</p>
                                    <p class="detail-label">Số Lượng Trong Kho: @Model.Quantity</p>
                                    <div class="product-inner-price">



                                        @{
                                            if (Model.Discount == 0 || Model.Discount == null || Model.Discount is string)
                                            {
                                                <ins>
                                                    @{



                                                        string formattedPrice = PhoneShop.Extension.Extension.ToVnd((double)Model.Price); // "C" là định dạng tiền tệ




                                                    }
                                                    @formattedPrice
                                                </ins>
                                            }
                                            else
                                            {
                                                <ins>
                                                    @{



                                                        string formattedPrice = PhoneShop.Extension.Extension.ToVnd((double)Model.Discount); // "C" là định dạng tiền tệ




                                                    }
                                                    @formattedPrice
                                                </ins>
                                            }
                                        }

                                        <del>
                                            @{
                                                string formattedPrice2;
                                                if (Model.Discount > 0)
                                                {
                                                    formattedPrice2 = PhoneShop.Extension.Extension.ToVnd((double)Model.Price); // "C" là định dạng tiền tệ
                                                }
                                                else
                                                {

                                                    formattedPrice2 = PhoneShop.Extension.Extension.ToVnd(tienO); // "C" là định dạng tiền tệ
                                                }


                                            }
                                            @formattedPrice2




                                        </del>
                                    </div>
                                    <div class="quantity">
                                        <input type="number" size="4" class="input-text qty text" title="Qty" value="1" name="quantity" min="1" step="1">
                                    </div>
                                    <button class="add-to-cart-btn"><a style="color:white" class="confirmAdd" data-id="@Model.Id">Thêm Vào Giỏ</a></button>
                                   <br />
                                   <br />
                                    <a>Mã Giảm Giá Của Shop</a>
                                    <div class="voucher-container">
                                        @foreach (var item in GetListVoucher)
                                        {
                                            <div class="voucher">
                                                <div class="voucher-left">
                                                </div>
                                                <div class="voucher-right">
                                                    <h4 style="color:red">Giảm: @Extension.ToVnd((double)item.DiscountProduct)</h4>
                                                    <h4>Áp Dụng Sp Của Shop</h4>
                                                    <h4>@item.ExpiryDate.ToString("dd/MM/yyyy")</h4>
                                                </div>
                                            </div>

                                        }
                                        
                                        
                                       

                                    </div>
                                </div>
                              

                              
                                   

                               
                                <div class="booth-container" style="background:#d7f9fa">
                                    <div class="booth-info">
                                        <h3 class="booth-name">@GetBooth.BoothName</h3>
                                        <div class="booth-details">
                                            <div class="detail-item">
                                                <span class="detail-label">Sản phẩm:</span>
                                                <span class="detail-value">@GetBooth.Quantity_Product</span>
                                            </div>
                                            <div class="detail-item">
                                                <span class="detail-label">Đánh giá:</span>
                                                <span class="detail-value">@GetBooth.Total_Comment</span>
                                            </div>
                                            <div class="detail-item">
                                                <span class="detail-label">Người theo dõi:</span>
                                                <span class="detail-value">@GetBooth.Followers</span>
                                            </div>
                                        </div>
                                    </div>
                                    <a href="/detail_booth/@GetBooth.BoothId" class="view-booth-btn">Xem Gian Hàng</a>

                                </div>
                               
                                    
                               

                            </div>
                        </div>
                    </div>

                    <br />
                    <hr />
                    <div class="row" style="min-height:500px;background:white;padding:10px">
                        <div class="col-sm-5">
                            <h3>Thông Số Sản Phẩm</h3>
                            <p><strong style="color:black">Camera:</strong> @Ispecifi.Camera</p>
                            <p><strong style="color:black">Bộ xử lý:</strong> @Ispecifi.Processor</p>
                            <p><strong style="color:black">Pin:</strong> @Ispecifi.Battery</p>
                            <p><strong style="color:black">Kết nối:</strong> @Ispecifi.Connectivity</p>
                            <p><strong style="color:black">Kích thước:</strong> @Ispecifi.DimensionsAndeight</p>
                            <p><strong style="color:black">Display:</strong> @Ispecifi.Display</p>
                            <p><strong style="color:black">Lưu trữ:</strong> @Ispecifi.InternalStorage</p>
                            <p><strong style="color:black">Hệ điều hành:</strong> @Ispecifi.OperatingSystem</p>
                            <p><strong style="color:black">Chống nước:</strong> @Ispecifi.WaterResistance</p>

                        </div>
                        <div class="col-sm-7" style="max-height: 500px;overflow-y: auto;">
                            <h3>Mô Tả Sản Phẩm</h3>
                            <p>@Html.Raw(Model.Description)</p>
                        </div>
                    </div>
                            
                    
                    
                </div>
            </div>
            
           
          

         
            
            
        </div>
        <br />
        <div class="container-question">

            <!-- Form bình luận  -->
            <form id="rating-form" asp-action="Review_Product" asp-controller="ProductReview" asp-route-id="@Model.Id" method="post" style="height: auto; border: 1px solid #ccc; box-shadow: 0 0 10px rgba(0, 0, 0, 0.2); padding: 20px;">
                <h3 style="text-transform: capitalize;" class="title_rw mb-0">Đánh giá sản phẩm</h3>
                <div style="display: flex; flex-direction: column; align-items: center;">
                    <div class="rating-container" style="margin-top: 10px; direction: rtl;">
                        <input type="radio" id="rating-5" name="rating" value="5" />
                        <label for="rating-5">&#9733;</label>
                        <input type="radio" id="rating-4" name="rating" value="4" />
                        <label for="rating-4">&#9733;</label>
                        <input type="radio" id="rating-3" name="rating" value="3" />
                        <label for="rating-3">&#9733;</label>
                        <input type="radio" id="rating-2" name="rating" value="2" />
                        <label for="rating-2">&#9733;</label>
                        <input type="radio" id="rating-1" name="rating" value="1" />
                        <label for="rating-1">&#9733;</label>
                    </div>
                    <textarea id="comment" name="content" placeholder="Nhập đánh giá của bạn..." style="width: 80%; height: 80px;resize: none; margin-top: 10px;" required></textarea>
                    @if (User.IsInRole("Seller") || User.IsInRole("User"))
                    {
                        <input class="btn btn-success" style="color:white; margin-top:10px" type="submit" value="Gửi">
                    }
                    else
                    {
                        <a href="/Login.html" class="btn btn-success" style="color:white; margin-top:10px">Cần đăng nhập</a>
                    }
                </div>
            </form>
            <div id="comment-section" style="height:400px;">

                <div class="card mb-4 border-0 bg-light">
                </div>
                @await Html.PartialAsync("_PartialProductReview",IsReview)


            </div>
        </div>
        <br /><br />
        <div class="container-question">

            <!-- Form bình luận -->
            <form id="comment-form" asp-action="Review_Product" asp-controller="Product" asp-route-id="@Model.Id" method="post" style="height: auto;">
                <h3 style="text-transform: capitalize;padding:10px;" class="title_rw mb-0">Hỏi và Đáp</h3>
                <div style="display: flex; flex-direction: column; align-items: center;">
                    <textarea id="comment" name="content" placeholder="Nhập bình luận của bạn..." style="width: 80%; height: 80px;resize: none;" required></textarea>

                    @if (User.IsInRole("Seller") || User.IsInRole("User"))
                    {
                        <input class="btn btn-success" style="color:white; margin-top:10px" type="submit" value="Gửi">
                    }
                    else
                    {
                        <a href="/Login.html" class="btn btn-success" style="color:white; margin-top:10px">Cần đăng nhập</a>
                    }
                </div>
            </form>
            <div id="comment-section" style="height:400px;">

                <div class="card mb-4 border-0 bg-light">
                </div>
                @await Html.PartialAsync("_PartialProductAsk",IsAsk)


            </div>
        </div>
        @await Html.PartialAsync("_PartialDetail_ProductRelated",IsSellingProduct)
    </div>

</div>

@section Scripts{
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>
        $(document).ready(function () {
            $('body').on('click', '.confirmAdd', function () {
                var id = $(this).data('id');

                var conf = confirm("Xác nhận thêm vào giỏ hàng");

                if (conf == true) {

                    $.ajax({

                        url: '/Cart/Add',
                        type: 'post',
                        data: { id: id },
                        success: function (rs) {
                            if (rs.success) {                              
                                // alert(rs.msg);
                                location.reload();
                            }
                        }

                    });

                }
            });

           

           
        });
    </script>


    <script>
        const thumbnails = document.querySelectorAll('.thumbnail-container img');
        const mainImage = document.querySelector('.image-container img');

        thumbnails.forEach((thumbnail, index) => {
            thumbnail.addEventListener('click', () => {
                // Remove "active" class from all thumbnails
                thumbnails.forEach(t => t.classList.remove('active'));
                // Add "active" class to the clicked thumbnail
                thumbnail.classList.add('active');

                // Hide all main images
                mainImage.classList.remove('active');
                // Show the corresponding main image
                mainImage.src = thumbnail.src;
                mainImage.classList.add('active');
            });
        });
    </script>

    <script>
        const ratingInputs = document.querySelectorAll('.rating-container input[type="radio"]');

        ratingInputs.forEach(input => {
            input.addEventListener('change', () => {
                const selectedRating = input.value;
                console.log('Selected rating:', selectedRating);
            });
        });
    </script>
   
  

}
