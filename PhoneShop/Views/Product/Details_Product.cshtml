@model PhoneShop.ModelViews.ProductViewModel

@using PhoneShop.ModelViews;
@using PhoneShop.Extension;
@{
    ViewData["Title"] = "Details_Product";
    Layout = "~/Views/Shared/_Layout.cshtml";

    List<ImageProductViewModel> IsImage = ViewBag.getListImage;

    List<Product_ReviewModelView> IsReview = ViewBag.ListReview;

    SpecificationsViewModel Ispecifi = ViewBag.GetSpecifi;


    List<ProductViewModel> IsSellingProduct = ViewBag.SellingProduct;

    List<ProductViewModel> IsGetProduct_RecentPosts = ViewBag.GetProduct_RecentPosts;

    Evaluate_ProductViewModel IsEvaluate_Pro = ViewBag.Evaluate_Product;

    double tienO = 0;

}


<style>
    textarea#comment {
        width: 666px;
        resize: none;
        padding: 12px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
        font-family: inherit;
    }

    .submit-btn {
        background-color: #4CAF50;
        color: white;
        padding: 12px 24px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        font-family: inherit;
        margin-top: 12px;
    }

        .submit-btn:hover {
            background-color: #45a049;
        }
    .comment-container {
        background-color: #f4f4f4;
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 5px;
    }

    .comment-author {
        font-weight: bold;
    }

    .comment-content {
        margin-top: 5px;
    }

    /* CSS cho thanh cuộn */
    #comment-section {
        height: 200px;
        overflow-y: scroll;
    }

    #load-more-comments {
        display: none;
        text-align: center;
        margin-top: 10px;
        cursor: pointer;
    }

  /*   //btn success */
    .add-to-cart-btn {
        background-color: #2980b9;
        color: #fff;
        border: none;
        border-radius: 4px;
        padding: 10px 20px;
        font-size: 14px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

        .add-to-cart-btn:hover {
            background-color: #3498db;
        }
  
  
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


<div class="container">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item" style="font-size: 18px;"><a href="#">Trang chủ</a></li>
            <li class="breadcrumb-item active" style="font-size: 18px;" aria-current="page">@ViewBag.getCategoryTitle</li>
            <li class="breadcrumb-item active" style="font-size: 18px;" aria-current="page">@Model.Title</li>
        </ol>
    </nav>
</div>



<div class="single-product-area" style="padding-top:30px">
    <div class="zigzag-bottom"></div>
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                

                <div class="single-sidebar">
                    <h2 class="sidebar-title">Bài đăng gần đây</h2>

                    @foreach (var itemm in IsGetProduct_RecentPosts)
                    {
                        <div class="thubmnail-recent">
                            <img src="~/images/Product/@itemm.ImageDefaultName" class="recent-thumb" alt="">
                            <h2><a href="">@itemm.Title</a></h2>
                            <div class="product-sidebar-price">
                                @{
                                    if (itemm.Discount == 0 || itemm.Discount == null || itemm.Discount is string)
                                    {
                                            <ins>
                                                @{
                                                string formattedPrice = PhoneShop.Extension.Extension.ToVnd((double)itemm.Price); // "C" là định dạng tiền tệ
                                                }
                                                @formattedPrice
                                            </ins>
                                    }
                                    else
                                    {
                                            <ins>
                                                @{
                                                string formattedPrice = PhoneShop.Extension.Extension.ToVnd((double)itemm.Discount); // "C" là định dạng tiền tệ
                                                }
                                                @formattedPrice
                                            </ins>
                                    }
                                }

                                <del>
                                    @{
                                        string formattedPriceee;
                                        if (itemm.Discount > 0)
                                        {
                                            formattedPriceee = PhoneShop.Extension.Extension.ToVnd((double)itemm.Price); // "C" là định dạng tiền tệ
                                        }
                                        else
                                        {

                                            formattedPriceee = PhoneShop.Extension.Extension.ToVnd(tienO); // "C" là định dạng tiền tệ
                                        }


                                    }
                                    @formattedPriceee




                                </del>
                            </div>
                        </div>
                    }

                 
                   
                </div>

                
            </div>

            <div class="col-md-8">
                <div class="product-content-right"> 
                  

                    <div class="row">
                        <div class="col-sm-6">
                            <div class="product-images">
                                <div class="product-main-img">
                                    <img src="~/images/Product/@Model.ImageDefaultName" alt="">
                                </div>

                              

                                <div class="product-gallery">

                                    @await Html.PartialAsync("_PartialListImage",IsImage)
                                    
                                   
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-6">
                            <div class="product-inner">
                                <h2 class="product-name">@Model.Title</h2>
                                <div class="product-inner-category"> 
                                    <p>Hãng: <a href="">@ViewBag.getCategoryTitle</a></p>
                                    <p style="color:red">Đã mua @IsEvaluate_Pro.Purchases lượt</p>
                                    <p style="color:#FFA500">Đánh giá @IsEvaluate_Pro.ScoreEvaluation điểm</p>
                                    <p style="color:#FFA500">Số lượng còn trong kho: @Model.Quantity</p>
                                </div>
                                <div class="product-inner-price">
                                


                                    @{
                                        if (Model.Discount == 0 || Model.Discount == null || Model.Discount is string)
                                        {
                                                <ins>
                                                    @{



                                                    string formattedPrice = PhoneShop.Extension.Extension.ToVnd((double)Model.Price); // "C" là định dạng tiền tệ




                                                    }
                                                    @formattedPrice
                                                </ins>
                                        }
                                        else
                                        {
                                                <ins>
                                                    @{



                                                    string formattedPrice = PhoneShop.Extension.Extension.ToVnd((double)Model.Discount); // "C" là định dạng tiền tệ




                                                    }
                                                    @formattedPrice
                                                </ins>
                                        }
                                    }

                                    <del>
                                        @{
                                            string formattedPrice2;
                                            if (Model.Discount > 0)
                                            {
                                                formattedPrice2 = PhoneShop.Extension.Extension.ToVnd((double)Model.Price); // "C" là định dạng tiền tệ
                                            }
                                            else
                                            {

                                                formattedPrice2 = PhoneShop.Extension.Extension.ToVnd(tienO); // "C" là định dạng tiền tệ
                                            }


                                        }
                                        @formattedPrice2




                                    </del>
                                </div>

                              
                                    <div class="quantity">
                                        <input type="number" size="4" class="input-text qty text" title="Qty" value="1" name="quantity" min="1" step="1">
                                    </div>
                                <button class="add-to-cart-btn"><a style="color:white" class="confirmAdd" data-id="@Model.Id">Thêm vào giỏ hàng</a></button>
                              

                                <ul class="nav nav-tabs">
                                    <li class="active"><a data-toggle="tab" href="#tab1">Mô tả</a></li>
                                    <li><a data-toggle="tab" href="#tab2">Thông số</a></li>
                                </ul>
                                    
                                <div class="tab-content" style="overflow-y: auto;">
                                    <div id="tab1" class="tab-pane fade in active" style="max-height: 200px; overflow-y: auto;">
                                        <p>@Html.Raw(Model.Description)</p>

                                        
                                    </div>
                                    <div id="tab2" class="tab-pane fade" style="max-height: 200px; overflow-y: auto;">
                                        <p><strong style="color:black">Camera:</strong> @Ispecifi.Camera</p>
                                        <p><strong style="color:black">Bộ xử lý:</strong> @Ispecifi.Processor</p>
                                        <p><strong style="color:black">Pin:</strong> @Ispecifi.Battery</p>
                                        <p><strong style="color:black">Kết nối:</strong> @Ispecifi.Connectivity</p>
                                        <p><strong style="color:black">Kích thước:</strong> @Ispecifi.DimensionsAndeight</p>
                                        <p><strong style="color:black">Display:</strong> @Ispecifi.Display</p>
                                        <p><strong style="color:black">Lưu trữ:</strong> @Ispecifi.InternalStorage</p>
                                        <p><strong style="color:black">Hệ điều hành:</strong> @Ispecifi.OperatingSystem</p>                                      
                                        <p><strong style="color:black">Chống nước:</strong> @Ispecifi.WaterResistance</p>

                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                              <!--  binh luan-->

                    

                          <!--  end binh luan-->
                    
                    
                </div>
            </div>
            <h1>Bình luận</h1>

            <div id="comment-section" style="height:400px">
                @await Html.PartialAsync("_PartialProductReview",IsReview)


            </div>

            <!-- Form bình luận -->
            <form id="comment-form" asp-action="Review_Product" asp-controller="Product" asp-route-id="@Model.Id" method="post">

                <br />

                <textarea id="comment" name="content" placeholder="Nhập bình luận của bạn..." style="width: 666px;resize: none;" required></textarea>
               

                @if (User.IsInRole("Seller") || User.IsInRole("User"))
                {
                    <input type="submit" value="Gửi bình luận">
                }
                else
                {
                    <a href="/Login.html" class="btn btn-success" style="color:white; margin-bottom:23px">Cần đăng nhập</a>
                }

            </form>
            @await Html.PartialAsync("_PartialDetail_ProductRelated",IsSellingProduct)
        </div>
    </div>
</div>

@section Scripts{
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>
        $(document).ready(function () {
            $('body').on('click', '.confirmAdd', function () {
                var id = $(this).data('id');

                var conf = confirm("Xác nhận thêm vào giỏ hàng");

                if (conf == true) {

                    $.ajax({

                        url: '/Cart/Add',
                        type: 'post',
                        data: { id: id },
                        success: function (rs) {
                            if (rs.success) {                              
                                // alert(rs.msg);
                                location.reload();
                            }
                        }

                    });

                }
            });

           

           
        });
    </script>

  

}
