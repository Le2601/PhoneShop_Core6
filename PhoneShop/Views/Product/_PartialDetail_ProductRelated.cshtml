@using PhoneShop.ModelViews
@model List<ProductViewModel>
@{


  ;
    //format tien

    // Lấy mã vùng địa phương cho tiếng Việt nếu có, nếu không thì chọn một mã vùng khác
    CultureInfo culture = CultureInfo.GetCultures(CultureTypes.SpecificCultures)
                                    .FirstOrDefault(c => c.Name.StartsWith("vi", StringComparison.OrdinalIgnoreCase))
                           ?? CultureInfo.CurrentCulture;

    int tienO = 0;
}
<div class="related-products-wrapper">
    <h2 class="related-products-title">Bán chạy</h2>
    <div class="product-carousel">

        @if (Model != null)
        {
            foreach (var item in Model)
            {
                <div class="single-product">
                    <div class="product-f-image">
                        @*                                         <img src="~/User/img/product-1.jpg" alt="">
                *@            <img src="~/images/Product/@item.ImageDefaultName" style="border: solid 1px;height:296px; width:220px" />

                        <div class="product-hover">
                            <a class="add-to-cart-link confirmAdd" data-id="@item.Id"><i class="fa fa-shopping-cart"></i> Thêm vào giỏ</a>
                            <a href="/chi-tiet/@item.Alias-@item.Id" class="view-details-link"><i class="fa fa-link"></i> Xem chi tiết</a>
                        </div>
                    </div>

                    <div style="height:45px">
                        <h2><a style="height:45px" href="/chi-tiet/@item.Alias-@item.Id">@item.Title </a></h2>
                    </div>


                    <div class="product-carousel-price">


                        @{
                            if (item.Discount == 0 || item.Discount == null || item.Discount is string)
                            {
                                <ins>
                                    @{






                                        string formattedPrice = PhoneShop.Extension.Extension.ToVnd((double)item.Price);

                                    }
                                    @formattedPrice
                                </ins>
                            }
                            else
                            {
                                <ins>
                                    @{





                                        string formattedPrice = PhoneShop.Extension.Extension.ToVnd((double)item.Discount);


                                    }
                                    @formattedPrice
                                </ins>
                            }
                        }

                        @{
                            string formattedPrice2;
                            if (item.Discount > 0)
                            {


                                formattedPrice2 = PhoneShop.Extension.Extension.ToVnd((double)item.Price);
                                <del>@formattedPrice2</del>
                            }



                        }






                    </div>

                </div>
            }
        }






    </div>
</div>


@section Scripts{
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>
        $(document).ready(function () {
            $('body').on('click', '.confirmAdd', function () {
                var id = $(this).data('id');

                var conf = confirm("Muon them vao gio hang");

                if (conf == true) {

                    $.ajax({

                        url: '/Cart/Add',
                        type: 'post',
                        data: { id: id },
                        success: function (rs) {
                            if (rs.success) {
                                alert("Them thanh cong");
                                // alert(rs.msg);
                                location.reload();
                            }
                        }

                    });

                }
            });
        });
    </script>


}

